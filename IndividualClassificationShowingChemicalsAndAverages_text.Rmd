
## Chemical Groups showing Chemicals

While the table above shows chemicals with their groups, it may be easier to understand when the data is shown in groups instead of individual chemicals. Some chemicals may appear in more than one category.  The list below shows the groups and chemicals found on your wristband.


```{r  ListClassFound, results='asis', echo=FALSE, message=FALSE}

oneResultInvertClassified<- as.data.frame(
  inner_join(oneResult_with_Y_flag,class_L,by="ParameterID") %>% 
    select(classification,ParameterName) %>%
    group_by(classification) %>%
    dplyr::summarise(ParameterNames=paste(ParameterName,collapse=", ")) %>%
    ungroup %>%
    mutate_if(is.factor, as.character) %>%  #Eliminate classification as a FACTOR so it sorts correctly
    arrange(classification))

names(oneResultInvertClassified)<-c("Chemical Group", "Chemical Name(s)" )



classExplainTable <- read.table(class_explain_table_name,  sep = ",",  header = TRUE   )

### NOTE INFO:---  Making this tooltip was TRICKY... if we want to change it just get rid of it... not worth the time
### NOTE INFO:---  Making this tooltip was TRICKY.but now the INDENT is right but still tooltip is long

# Create tooltips for each word with improved formatting and indentation
# create_tooltipNew <- function(classIf) {
#   # Filter for the classification row
#   class_row <- classExplainTable %>% filter(Classification == classIf)
#   
#   # If no match, return the classification name as-is
#   if (nrow(class_row) == 0) {
#     return(classIf)
#   }
#   
#   # Generate each line of the tooltip with indents and HTML spans
#   description <- tags$span(style = "margin-left: 20px;", title = class_row$Description, "Description")
#   sources <- tags$span(style = "margin-left: 20px;", title = class_row$Sources, "Sources")
#   examples <- tags$span(style = "margin-left: 20px;", title = class_row$Examples, "Examples")
#   strategies <- tags$span(style = "margin-left: 20px;", title = class_row$Strategies, "Strategies")
#   
#   # Assemble the formatted tooltip content
#   tooltip_content <- paste0(
#     classIf, '<br>',
#     as.character(description), '<br>',
#     as.character(sources), '<br>',
#     as.character(examples), '<br>',
#     as.character(strategies)
#   )
#   
#   return(tooltip_content)
# }
# 
# 
# # Create tooltips with visual styling for interactivity
# create_tooltip <- function(classIf) {
#   # Filter for the classification row
#   class_row <- classExplainTable %>% filter(Classification == classIf)
#   
#   # If no match, return the classification name as-is
#   if (nrow(class_row) == 0) {
#     return(classIf)
#   }
#   
#   # Define each tooltip section with inline styling for hover effect
#   description <- tags$span(
#     style = "margin-left: 20px; color: blue; text-decoration: underline; cursor: pointer;",
#     title = class_row$Description, "Description"
#   )
#   sources <- tags$span(
#     style = "margin-left: 20px; color: blue; text-decoration: underline; cursor: pointer;",
#     title = class_row$Sources, "Sources"
#   )
#   examples <- tags$span(
#     style = "margin-left: 20px; color: blue; text-decoration: underline; cursor: pointer;",
#     title = class_row$Examples, "Examples"
#   )
#   strategies <- tags$span(
#     style = "margin-left: 20px; color: blue; text-decoration: underline; cursor: pointer;",
#     title = class_row$Strategies, "Strategies"
#   )
#   
#   # Assemble the formatted tooltip content
#   tooltip_content <- paste0(
#     classIf, '<br>',
#     as.character(description), '<br>',
#     as.character(sources), '<br>',
#     as.character(examples), '<br>',
#     as.character(strategies)
#   )
#   
#   return(tooltip_content)
# }



# Apply the function to create tooltips
#oneResultInvertClassified$"Chemical Group" <- sapply(oneResultInvertClassified$"Chemical Group", create_tooltipNew)  # THIS WORKS
#oneResultInvertClassified$"Chemical Group" <- sapply(oneResultInvertClassified$"Chemical Group", create_tooltip)  # attempt 114
## GET RID OF TOOLTIP COMPLETELY... It didn't look or work perfectly

#Print the table with tooltips
pandoc.table(oneResultInvertClassified,
             caption = "Chemical Group Report on your Wristband",
             justify = c("left", "center"),
             split.table = Inf,
             emphasis.rownames = TRUE)

# knitr::kable(oneResultInvertClassified, format = "html", escape = FALSE) %>%
#  kable_styling(full_width = F)


```
